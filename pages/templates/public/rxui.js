!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.rxui=t(require("react"),require("react-dom")):e.rxui=t(e.React,e.ReactDOM)}(window,(function(__WEBPACK_EXTERNAL_MODULE__1__,__WEBPACK_EXTERNAL_MODULE__4__){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s}));const r="_rxui_meta_",o="_hc_",i="_hc_from_",c="_ignore_",f="_ignore_observable_",u="_ignore_me_",s="function"==typeof HTMLElement?HTMLElement:function(){};"function"==typeof SVGElement&&SVGElement},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1__},function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return f})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return h}));var r=n(6),o=n(0);function i(e,t){const n=e[o.c];return!!n&&n[t]}function c(e){return e[o.a]||e[o.b]}function f(e){if("function"==typeof HTMLElement)return e instanceof HTMLElement;e&&"object"==typeof e&&(1===e.nodeType||9===e.nodeType)&&e.nodeName}function u(e="u_",t=5){return e+Object(r.a)(t)}function s(e,t){let n;if("string"==typeof t){let e=t.lastIndexOf(".");n=-1!==e?t.substring(e+1):t}else n=e.name;return n.replace(/[^\w]/gi,"_")}function a(e,t){let n=[];do{if(e==Object.prototype||e==Function.prototype)break;try{n=n.concat(Object.getOwnPropertyNames(e))}catch(e){console.error(e)}}while(e=Object.getPrototypeOf(e));return n.filter(n=>{if(!t||t&&"function"!=typeof e[n])return"constructor"!=n&&!/^__.+/g.test(n)})}function l(e,t){let n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){let r=e;for(;void 0===n&&null!=(r=Object.getPrototypeOf(r))&&r!==Object.prototype;)n=Object.getOwnPropertyDescriptor(r,t)}return n}function p(e){return"symbol"==typeof e||function(e){return"object"==typeof e&&null!==e}(e)&&"[object Symbol]"===Object.prototype.toString.call(e)}function d(){let e,t=[];return{push(n,...r){t.find(e=>e.task===n)||t.push({task:n,args:r}),e||(e=1,Promise.resolve().then(()=>{e=void 0,t.forEach(({task:e,args:n},r)=>{e(...n),t[r]=void 0}),t=t.filter(e=>e)}))}}}const _={};function h(t,n){const r="object"==typeof window?window:"object"==typeof e?e:_;let o;if(r){let e=r.__rxui__;void 0===e&&(e=r.__rxui__={}),o=e[t]?e[t]:e[t]=n}else o=n;return o}}).call(this,n(8))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return SerializedReg})),__webpack_require__.d(__webpack_exports__,"a",(function(){return Ignore})),__webpack_require__.d(__webpack_exports__,"b",(function(){return Serializable})),__webpack_require__.d(__webpack_exports__,"d",(function(){return searchForMeta}));var _util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0);const SerializedReg=Object(_util__WEBPACK_IMPORTED_MODULE_0__.i)("_rxui_serializedReg_",{});function Ignore(e,t){let n=Object.getOwnPropertyDescriptor(e,_constants__WEBPACK_IMPORTED_MODULE_1__.c);if(n)n.value[t]=!0;else{let n,r=Object.getPrototypeOf(e);for(;r&&r!==Object.prototype&&(n=Object.getOwnPropertyDescriptor(r,_constants__WEBPACK_IMPORTED_MODULE_1__.c),!n);)r=Object.getPrototypeOf(r);const o=Object.assign({},n&&n.value);Object.defineProperty(e,_constants__WEBPACK_IMPORTED_MODULE_1__.c,{value:o,writable:!0}),o[t]=!0}}function Serializable(e){if(1==arguments.length){const e=arguments[0];if("function"==typeof e)return hashcodeFn(e);if("string"==typeof e)return function(t){return hashcodeFn(t,e)};if("object"==typeof e&&"string"==typeof e.name){let{name:t,load:n}=e;return function(e){return hashcodeFn(e,t,n)}}throw new Error("@Serializable's param error.")}throw new Error("@Serializable should be used to decorate class only.")}function searchForMeta(e){let t;const n=e.constructor&&e.constructor[_constants__WEBPACK_IMPORTED_MODULE_1__.f],r=Object.getPrototypeOf(e),o=r&&searchForMeta(r);return o?(t=Object.assign({},n||{}),Object.keys(o).forEach(e=>{t[e]=n&&n[e]?Object.assign({},o[e],n[e]):Object.assign({},o[e])}),t):n}function hashcodeFn(fn,name,load){if("string"==typeof name&&SerializedReg[name])throw new Error(name+" had been registered.");let fnName=name?Object(_util__WEBPACK_IMPORTED_MODULE_0__.b)(fn,name):fn.name;const getUid=_util__WEBPACK_IMPORTED_MODULE_0__.j;let proxyFn=null,proto;return eval(`\n    proxyFn = function ${fnName}() {//Proxied and named\n      try {\n        const _this = new fn(...arguments)\n\n        Object.defineProperty(_this, '${_constants__WEBPACK_IMPORTED_MODULE_1__.a}', {\n          value: getUid('${fnName}_'),\n          writable: true,\n          enumerable: false\n        })\n\n        Object.setPrototypeOf(_this, proto)\n        return _this\n      } catch (ex) {//not support ES6?\n        throw ex\n\n        // var args = []\n        //\n        // for(var i=0;i<arguments.length;i++){\n        //   args.push(arguments[i])\n        // }\n        // fn.apply(this,args)\n        //\n          // Object.defineProperty(this, '${_constants__WEBPACK_IMPORTED_MODULE_1__.a}', {\n          //     value:getUid('${fnName}_'),\n        //     writable: true,\n        //     enumerable:false\n        // })\n      }\n    }\n    proto = {\n      constructor: proxyFn\n    }\n    var statics = Object.getOwnPropertyNames(fn)\n    var regc = /^(length|name|prototype)$/gi\n    for (var i = 0; i < statics.length; i++) {\n      var nm = statics[i]\n      if (!nm.match(regc)) {\n        proxyFn[nm] = fn[nm]\n      }\n    }\n    Object.setPrototypeOf(proto, fn.prototype)\n    proxyFn.prototype = proto\n  `),"string"==typeof name&&(SerializedReg[name]={proto:proxyFn,load:load},setMeta(proxyFn,"serialized","name",name)),proxyFn}function setMeta(e,t,n,r){const o=0==Object.getOwnPropertyNames(e).filter(e=>e==_constants__WEBPACK_IMPORTED_MODULE_1__.f).length?e[_constants__WEBPACK_IMPORTED_MODULE_1__.f]={}:e[_constants__WEBPACK_IMPORTED_MODULE_1__.f];(o[t]||(o[t]={}))[n]=r||e[n]}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__4__},function(e,t,n){"use strict";var r=n(4);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));let r=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_","")},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"stopWatch",(function(){return Ke})),n.d(t,"keepWatch",(function(){return ze})),n.d(t,"stopUpdate",(function(){return Ve})),n.d(t,"render",(function(){return y})),n.d(t,"createRoot",(function(){return g})),n.d(t,"useObservable",(function(){return pe})),n.d(t,"useComputed",(function(){return he})),n.d(t,"useWatcher",(function(){return ge})),n.d(t,"useOnce",(function(){return me})),n.d(t,"observe",(function(){return be})),n.d(t,"observable",(function(){return fe})),n.d(t,"implement",(function(){return je})),n.d(t,"from",(function(){return xe})),n.d(t,"fork",(function(){return Te})),n.d(t,"IgnoreObservable",(function(){return Pe})),n.d(t,"undo",(function(){return Me})),n.d(t,"redo",(function(){return Re})),n.d(t,"takeSnap",(function(){return Ue})),n.d(t,"snap",(function(){return Z})),n.d(t,"Serializable",(function(){return C.b})),n.d(t,"Ignore",(function(){return C.a})),n.d(t,"dump",(function(){return V})),n.d(t,"load",(function(){return $})),n.d(t,"deserialize",(function(){return F})),n.d(t,"recycle",(function(){return H})),n.d(t,"clone",(function(){return J})),n.d(t,"ignore",(function(){return G})),n.d(t,"dragable",(function(){return ke})),n.d(t,"getPositionInKonva",(function(){return Fe})),n.d(t,"getPosition",(function(){return $e})),n.d(t,"evt",(function(){return Be})),n.d(t,"uuid",(function(){return u.j}));var r=n(1),o=n.n(r),i=n(4),c=n(5);const f=["onContextMenu","onClick","onDoubleClick","onMouseDown","onMouseUp","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onDrop","onDrag","onDragStart","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDragExit","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","onKeyPress","onKeyDown","onKeyUp","onCopy","onCut","onPaste","onChange","onInput","onSubmit","onFocus","onBlur","onScroll"];var u=n(2);const{ReactCurrentDispatcher:s,ReactCurrentOwner:a}=o.a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Object(u.i)("CurrentNodeInfo",{});let p,d;const _=o.a.createContext(!1),h=function(...e){return m(i.render,...e)};h.test=function(e,t){return m(i.render,t)};var y=h;const g=function(...e){const t=Object(c.createRoot)(...e);return{unmount:(...e)=>t.unmount.call(t,...e),render:(...e)=>m(t,...e)}};function m(e,...t){if(p||(p=o.a.createElement,o.a.createElement=d=function(...e){if(!l.current&&!_.Consumer._currentValue)return p(...e);let t;if(e.length>0&&"function"==typeof(t=e[0])){if(!t.prototype||!(t.prototype instanceof o.a.Component)&&void 0===t.prototype.isReactComponent){const n=b(t);e.splice(0,1,n);const r=e[1]||{};if(r._parent_info_&&(console.warn("private prop _parent_info_ exist."),delete r._parent_info_),!r._parent_info_)try{Object.defineProperty(r,"_parent_info_",{value:o.a.createElement._cur_parent_info_,writable:!1,enumerable:!0,configurable:!1})}catch(e){console.info(`Object.defineProperty 'PARENT_NODE_INFO' error,in object ${r}.`)}e.splice(1,1,r)}return p(...e)}if("string"==typeof e[0]){const t=e[1];if(t){const e=o.a.createElement._render_in_node_info_;if(e){const n=e.id;f.forEach(e=>{let r=t[e];"function"==typeof r&&(t[e]=function(...e){let t;return D.curRT.setNodeInfoId(n),Object(i.unstable_batchedUpdates)(()=>{try{t=r(...e)}finally{}}),D.curRT.clear(),t})})}}}return p(...e)}),t.length>0){let e=t[0];if(e){if("function"==typeof e){o.a.createElement=p;try{e=e()}catch(e){throw e}finally{o.a.createElement=d}}const n=e.type,r=e.props;if(n){const i=b(n),c=e.key?{key:e.key,ref:e.ref}:{ref:e.ref},f=o.a.createElement(_.Provider,{value:!0},o.a.createElement(i,Object.assign(c,r)));t.splice(0,1,f)}}}if("function"==typeof e){return e.call(void 0,...t)}if("object"==typeof e){return e.render.call(e,...t)}}function b(e){let t=!1,n=e.__enhanced__;if(!n){"object"==typeof e&&e.$$typeof===Symbol.for("react.forward_ref")&&(t=!0),t?(e.render=v(e.render,!1),n=Object(r.memo)(e)):n=v(e);try{e.__enhanced__=n}catch(e){}}const o=Object.getOwnPropertyNames(e);return o&&o.forEach(t=>{try{n[t]=e[t]}catch(e){console.error(e)}}),n}function v(e,t=!0){function n(t,i){const c=Object(r.useMemo)(()=>{const n={id:Object(u.j)(),version:0,name:e.name,component:e,parent:D.searchNode(t._parent_info_),props:t,responsives:new Set,children:[],subjectAry:[],observerAry:[],implementAry:[]};return D.regNode(n),n},[]);l.current=c,o.a.createElement._cur_parent_info_=c.id,o.a.createElement._render_in_node_info_=c;let f={_from_:"render",hoc:n,nodeInfo:c,update:j(),_curSnap:void 0,getSnap(){if(!this._curSnap){const e=this;this._curSnap={_snap_:!0,version:e.nodeInfo.version,_from_:e._from_,hoc:e.hoc,nodeInfo:e.nodeInfo,update:e.update,getSnap:()=>e._curSnap}}return this._curSnap},updateSnap(){this._curSnap&&(this._curSnap.invalid=!0,this._curSnap=void 0)}};Object(r.useEffect)(()=>()=>{D.cleanUpdater(f),f=void 0},[]),D.setCurUpdater(f);const a=s.current;let p,d;if(a){const e=a.useMemo;if(p=a.useEffect,c){if(e&&!e._rxui_){const n=function(n,r){return e((function(...e){let r;try{r=D.stopWatch(()=>n(...e))}catch(e){E("useMemo",t,e)}return r}),r)};n._rxui_=!0,a.useMemo=n}if(p&&!p._rxui_){const e=function(e,n){return p((function(...n){let r;D.curRT.setNodeInfoId(c.id);try{r=e(...n)}catch(e){E("useEffect",t,e)}finally{D.curRT.clear()}return r}),n)};e._rxui_=!0,a.useEffect=e}}}try{d=e(t,i)}catch(e){d=E("render",t,e)}return null==d&&(d=o.a.createElement(o.a.Fragment)),p&&(a.useEffect=p),Object(r.useLayoutEffect)(()=>{D.setCurUpdater(void 0)}),l.current=void 0,o.a.createElement._render_in_node_info_=c.parent,d}return n.displayName=e.displayName||e.name,t?Object(r.memo)(n):n}function E(e,t,n){if(!t||"function"!=typeof t._onError_&&"function"!=typeof t._onerror_){const r=t._parent_info_;if(r){const t=D.searchNode(r);if(null==t?void 0:t.props)return E(e,t.props,n)}throw n}return(t._onError_||t._onerror_)(n,e)}function j(){const[e,t]=Object(r.useState)(0);return Object(r.useCallback)(e=>{t(e=>e+1)},[])}const O=Object(u.i)("nodes",{});let w,x,T=null;const P=Object(u.i)("IgnoreRx",{stopWatcher:void 0,stopUpdate:void 0});let A=Object(u.i)("curUpdater",{cur:void 0});const I=Object(u.i)("batchStack",[]);var D;function S(e,t){return e&&t&&e.nodeInfo&&t.nodeInfo&&e.nodeInfo.id===t.nodeInfo.id&&e.hoc===t.hoc}!function(e){function t(e){return O[e]}e.curRT={setNodeInfoId(e){w=e},setInfoIdForDelay(){x=w},getNode(){const e=l.current;if(e)return O[e.id];if(w){const e=O[w];if(e)return e}return x?O[x]:void 0},clear(){w=null},clearDelay(){x=null}},e.regNode=function(e){if(O[e.id]=e,T){let n,r=e.parent;if(r){if(r.invalid)return;n=t(r.id),e.parent=n,n.children.push(e)}}else T=e},e.regListener=function(e,n){const r=l.current;if(!r)throw new Error("CurrentNodeInfo.current is undefined.");const o=t(r.id);return n&&o[e+"Ary"].push(n),o},e.getCurNode=function(){const e=l.current;if(!e)throw new Error("CurrentNodeInfo not found.");return t(e.id)},e.searchNode=t,e.setCurUpdater=function(e){A&&(A.cur=e)},e.getCurUpdater=function(){if(A)return A.cur},e.stopWatch=function(e){if("function"==typeof e){P.stopWatcher=!0;try{return e(()=>{P.stopWatcher=void 0})}finally{P.stopWatcher=void 0}}},e.keepWatch=function(e){if("function"==typeof e){const t=P.stopWatcher;P.stopWatcher=void 0;try{return e(()=>{P.stopWatcher=t})}finally{P.stopWatcher=t}}},e.stopUpdate=function(e){if("function"==typeof e){P.stopUpdate=!0;try{return e(()=>{P.stopUpdate=void 0})}finally{P.stopUpdate=void 0}}},e.igonreObservableBefore=function(){A={}},e.cleanUpdater=function(e){try{e.updateSnap(),function e(t,n){var r;null===(r=t.responsives)||void 0===r||r.forEach(e=>{e.forEach((n,r)=>{n.nodeInfo&&!n.nodeInfo.invalid&&n.nodeInfo.id!==t.id||e.splice(r,1)})});const o=O[t.id];if(o){if(o.parent){const e=o.parent.children;e.forEach((n,r)=>{n.id===t.id&&e.splice(r,1)})}o.children&&o.children.forEach(t=>{e(t)}),O[t.id]=null,delete O[t.id]}t.component=null,t.invalid=!0,t.props=null}(e.nodeInfo),e.nodeInfo&&(e.nodeInfo=null),e.hoc=null,e.update=null}catch(e){console.error(e)}},e.applyBatch=function(){const e=[];return I.push(e),{commit(){I.pop(),e.forEach(e=>{e&&e.nodeInfo&&!e.nodeInfo.invalid&&e.update(e)})},cancel(){I.pop()}}};const n=function(){let e,t=[];return{clear(){t=[]},push(n){t.find(e=>S(e,n))||t.push(n.getSnap()),e||(e=1,Promise.resolve().then(()=>{e=void 0,t.forEach((e,n)=>{t[n]=void 0,e&&e.nodeInfo&&!e.nodeInfo.invalid&&(e.invalid?console.log("updater.invalid",e):e.update())}),t=t.filter(e=>e)}))}}}();e.applyAgent=function(){const t={};return{push(n,r){if(P.stopWatcher)return;let o=t[r];o||(o=t[r]=[]);const i=e.getCurUpdater();if(i){let e;i.nodeInfo,i.nodeInfo.responsives.add(o),o.find((t,n)=>{if(S(t,i))return e=n,!0})?e>=0&&(o[e]=i.getSnap()):o.push(i.getSnap())}},update(r,o,c){if(P.stopUpdate)return;const f=r+"="+("function"==typeof c?"function":"object"==typeof c?"{..}":c),u=I[I.length-1];if(u){const e=t[o];e&&e.length>0&&e.forEach(e=>{!e.nodeInfo||e.nodeInfo.invalid||u.find(t=>S(t,e))||(e.watch=`[${e.nodeInfo.id}]${f}`,u.push(e))})}else{let r=t[o];if(r)try{Object(i.unstable_batchedUpdates)(()=>{r.forEach((t,o)=>{if(t&&t.nodeInfo&&!t.nodeInfo.invalid&&!t.invalid){t.watch=`[${t.nodeInfo.id}]${f}`;const r=e.getCurUpdater();if(w&&r&&r===t)return;return r&&r.nodeInfo.id!==t.nodeInfo.id?w&&w===t.nodeInfo.id?t.update(t):n.push(t):t.update(t),t}r.splice(o,1)})}),0===t[o].length&&(t[o]=void 0,delete t[o])}catch(e){console.error(e)}}}}}}(D||(D={}));const M={},R={};var C=n(3),W=n(0);let U,k,L,N;function $(e,t){if("object"!=typeof e)throw new Error("Invalid data format.");ae(e)&&(e=se(e)),e=JSON.parse(JSON.stringify(e));const n=D.applyBatch(),r={};L="_F_",N="_R_";for(let n in e){const o=e[n];if(t){const e=F(o);r[n]=e}else F(o,{merge(e){const t=M[n];void 0!==t?r[n]=B(e,t):R[n]=t=>{const o=D.applyBatch();r[n]=B(e,t),o.cancel()}}})}return n.commit(),r}function F(e,t={}){if("object"!=typeof e||"object"!=typeof e.def||"object"!=typeof e.refs)throw new Error("Invalid data format.");const{merge:n}=t,{def:r,refs:o,D:i,consts:c}=e;if(c)L="_from_",N="_ref_",U={C:c.froms,W:{}};else if(i)if(i.W){const e={};Object.keys(i.W).forEach(t=>{e[i.W[t]]=t}),i.W=e,U=i}else U=Object.assign({W:{}},i);else U={C:{},W:{}};k={refs:o,didMap:{}},Object.keys(o).forEach(e=>{let t,n=o[e];if(void 0!==(t=n[L])){t=U.C[t]||t;const r=C.c[t];if(!r)return;if(!r||!r.proto)throw new Error("Invalid data format.");{const i=z(r.proto);i[L]=t,i._merge_data_=n,o[e]=i}}});const f=r;if(!n)return K(f);n(f)}function B(e,t){const n=K(e,t);return n&&"object"==typeof n&&t?(Object.keys(n).forEach(e=>{let r=n[e];t[e]=r}),t):n}function K(e,t){const{refs:n,didMap:r}=k;if(Array.isArray(e))return e.map(e=>K(e));if("object"==typeof e&&e){if(e[W.a])return r[e[W.a]]=t||e,t||e;const o=e[N];if("string"==typeof o){if(!t&&r[o])return r[o];e=n[o],r[o]=t||e}let i,c;if(c=e[L]){if(i=C.c[c],!i)return;if(!i||!i.proto)throw new Error("Invalid data format.")}delete e[L];let f=e._merge_data_;if(void 0===f&&i&&(f=e,e=z(i.proto)),f){delete e._merge_data_,delete f[L];let t=Object(u.c)(f);if(t.length>0){const n=f[W.c];t.forEach(t=>{let r=U.W[t],o=f[t];if(r?(f[t]=void 0,delete f[t]):r=t,t===W.c)return;const c=Object(u.e)(e,r);if(!(c&&c.get&&!c.set||n&&n[r]||n&&n[r])){const t=K(o);try{let n;if(i&&"function"==typeof(n=i.load)){let o=n(e,r,t);void 0!==o&&(e[r]=o)}else try{e[r]=t}catch(e){throw e}}catch(e){throw e}}})}}else{let t=Object(u.c)(e);if(t.length>0){const n=e[W.c];t.forEach(t=>{let r=U.W[t],o=e[t];if(r?(e[t]=void 0,delete e[t]):r=t,t===W.c)return;const c=Object(u.e)(e,r);if(!(c&&c.get&&!c.set||n&&n[r]||n&&n[r])){n&&console.log(r);const t=K(o);let c;const f=Object(u.e)(e,r);if(f&&f.get&&!f.set)return;if(i&&"function"==typeof(c=i.load)){let n=c(e,r,t);void 0!==n&&(e[r]=n)}else try{e[r]=t}catch(e){throw e}}})}}}return e}function z(e){return new e}function V(e,t={}){const n=(e,t,n)=>n;if("string"==typeof e){if(M[e])return X(M[e],n,Object.assign(t,{noFunction:!0}))}else if(e&&"object"==typeof e)return X(e,n,Object.assign(t,{noFunction:!0}))}function X(e,t,n={}){const{noFunction:r,uncompressed:o,map:i}=n;let c={},f={},s={C:[],W:o?void 0:{}},a=0;let l={},p=0;function d(e){if(o)return e;let t=l[e];return void 0===t&&(l[e]=t=p+++""),t}const _={D:s,refs:c,def:function e(n){if("object"!=typeof n||!n)return n;if(q(n))return;if(n[W.a]){const e=d(n[W.a]);if(c[e])return{_R_:e};if(f[e])return{_R_:e}}let l={};if(Array.isArray(n)&&(l=[]),n[W.a]&&(f[d(n[W.a])]=!0),Array.isArray(n)){const r=[];Object.keys(n).forEach(o=>{try{if(o.match(/^__.+__$/g)||l[o])return}catch(e){}const i=n[o];q(i)?(r.push(o),l[o]=void 0):l[o]=e(t(n,o,i))}),r.length>0&&r.forEach(e=>l.splice(e,1))}else{let c=Object(u.c)(n);if(c.length>0){const f=n[W.c];c.forEach(c=>{if(c===W.c||c===W.e||"_from_"===c||"_hc_temp_"===c)return;const p=Object(u.e)(n,c);if((!p||!p.get||p.set)&&(!f||!f[c])){let f=n[c];if(!r||r&&"function"!=typeof f&&!Object(u.g)(f))if("function"==typeof i&&(f=i(n,c,f)),c!==W.a&&"_F_"!==c){const r=function(e){if(o)return e;if(/^[0-9]+$/.test(e))return e;if(/^u_/.test(e))return e;let t=s.W[e];return void 0===t&&(s.W[e]=t="_"+a+++"_"),t}(c);l[r]=e(t(n,c,f))}else l[c]=f}})}!0===n._observable_&&(l._observable_=!0);const f=Object(C.d)(n);let p;if(f&&(p=f.serialized)){s.C.find(e=>e===p.name);let e=s.C.indexOf(p.name);-1===e&&(s.C.push(p.name),e=s.C.length-1),l._F_=e}else if(n[W.a])throw new Error("Invalid data format.")}if(l[W.a]){const e=d(l[W.a]);return c[e]=l,delete l[W.a],{_R_:e}}return l}(e)};return f=void 0,_}function q(e){return e&&"object"==typeof e&&e[W.d]}function Y(e,t,n){var r;if(n&&"function"==typeof n){const e=Object(C.d)(t);if(!(null===(r=null==e?void 0:e.serialized)||void 0===r?void 0:r.name))throw new Error("No @Serializable({name:string}|string) decorator on "+n)}const o=R[e];void 0!==o&&o(t),M[e]=t}function H(e){if(!e[W.a])throw new Error(`Model must has ${W.a} property.`);let t=!1,n={},r=o=>{if("object"==typeof o&&null!==o){if(o[W.a]==e[W.a])return!0;if(n[o[W.a]])return;n[o[W.a]]=!0;Object(u.c)(o).forEach(e=>{const n=Object(u.e)(o,e);if(n&&n.get&&!n.set)return;let i=o[e];Array.isArray(i)?(i=i.map(e=>r(e)?void(t=!0):e),t&&(o[e]=i.filter(e=>void 0!==e))):r(i)&&(t=!0,o[e]=void 0)})}};return Object.keys(M).forEach(e=>{r(M[e])}),n=void 0,t}function J(e,t){if(void 0===e)return e;let n=[];return function e(r){if("object"!=typeof(r=se(r))||!r)return r;for(let e=0;e<n.length;e++)if(n[e].target===r)return n[e].copyTarget;let o={};if(Array.isArray(r)&&(o=[]),n.push({target:r,copyTarget:o}),Array.isArray(r))Object.keys(r).forEach(t=>{/^__.+__$/g.test(t)||o[t]||(o[t]=e(r[t]))});else if(r instanceof RegExp);else{let n=Object(u.c)(r);if(n.length>0){let i=r[W.c];n.forEach(n=>{if(n!==W.a&&(t||!i||!i[n])){const t=Object(u.e)(r,n);t&&t.get?Object.defineProperty(o,n,{get:()=>e(r[n])}):o[n]=e(r[n])}})}}return o}(e)}function G(e){"object"==typeof e&&(e[W.d]=!0)}const Q=/^before\@splice$/;let Z;class ee{constructor(e){this._undo={states:[],reg:new WeakMap},this._redo={states:[],reg:new WeakMap},this.listener=e}setUndo(e,t,n,r){this.sleeping||this.set(e,t,n,this._undo)&&this.listener&&(void 0!==r&&!0!==r||this.listener(e,t,n))}setRedo(e,t,n,r){this.sleeping||this.set(e,t,n,this._redo)&&this.listener&&(void 0!==r&&!0!==r||this.listener(e,t,n))}sleep(e){this.sleeping=!0;try{"function"==typeof e&&e()}catch(e){throw e}finally{this.sleeping=!1}}dump(){return Z=null,this}undo(){Z=null;const e=D.applyBatch();try{this._undo.states.forEach(({obj:e,prop:t,val:n})=>{let r;r=Array.isArray(e)&&"length"===t?n:te(t)?e:e[t],this.setRedo(e,t,r,!1),this.setVal(e,t,n)}),e.commit()}catch(t){console.error(t),e.cancel()}}redo(){Z=null;const e=D.applyBatch();try{this._redo.states.forEach(({obj:e,prop:t,val:n})=>{let r;r=te(t)?n:e[t],this.setUndo(e,t,r,!1),this.setVal(e,t,n)}),e.commit()}catch(t){console.error(t),e.cancel()}}cancel(){Z=null}set(e,t,n,r){let o=r.reg.get(e);if(o||(o={},r.reg.set(e,o)),!(t in o)){if(o[t]=n,Array.isArray(e)&&te(t)){const n=[];e.forEach(e=>n.push(e)),r.states.push({obj:e,prop:t,val:n})}else r.states.push({obj:e,prop:t,val:n});return!0}}setVal(e,t,n){if(Array.isArray(e)){const r=e;te(t)?(r.splice(0,e.length),n.forEach(t=>{e.push(t)})):t.match(/^\d+$/)&&void 0===n?e.splice(parseInt(t),1):"length"===t?e.length===n&&(e[t]=n):e[t]=n}else e[t]=n;this.listener&&this.listener(e,t,n)}}function te(e){return e.match(Q)}class ne extends Error{}const re=new WeakMap,oe=new WeakMap,ie=Object(u.a)(),ce=new WeakMap;function fe(e,t=e,n,r){let o,i,c;"function"==typeof e&&(e=new e),"object"==typeof n&&(n.to||(o=n.expectTo),Array.isArray(n.ignore)&&(i=n.ignore),"function"==typeof n.watch&&(c=n.watch));const f=[];function s(e,t,n,r,o){c&&c(t,r,o);let i=e;do{const{source:e}=i,c=oe.get(e);c&&c.forEach(({on:i,exe:c,node:f,target:u})=>{f.invalid||e!==se(u)||t.match(new RegExp(`.${i}$`))&&ie.push(c,n,r,o)})}while(i=i.parent)}return function e(n,c,a="",l){if(ae(n))return n;if("object"==typeof n&&"_isVue"in n)return n;const p={},d={get(e,t,n){let r;if("function"==typeof t)[e]in p?r=p[e]:p[e]=r=n();else{if(ae(t))return t;r=re.get(t),void 0===r&&re.set(t,r=n())}return r}};l&&ce.set(n,`${Object(u.d)(c.source)}_${l}`);const _={source:n,proxy:void 0,parent:c},h=D.applyAgent(),y=new Proxy(n,{has:(e,t)=>"__observable__"===t||"__original__"===t||t in e,get(s,l,p){if(s instanceof RegExp)return s[l];if("__observable__"===l)return!0;if("toString"===l||"toJSON"===l||"valueOf"===l||"$$typeof"===l||"constructor"===l||Object(u.h)(l))return s[l];if("__original__"===l)return"__original__"in s?s.__original__:se(n);if("__isExpectTo__"===l)return o;if("__pushWatch__"===l)return e=>{let t=oe.get(n);t||oe.set(se(n),t=new Set),t.has(e)||t.add(e)};if("__pushJoinFrom__"===l)return(e,t)=>{t.forEach(([t,n])=>{const r=t.split("."),o=n.split(".");let i,c=e,f=p;r.forEach((e,t)=>{c=c[e],t===r.length-1&&(i="object"==typeof c&&c?J(c):c)}),o.forEach((e,t)=>{if(t===o.length-1)f[e]=i;else if(f=f[e],!f)return!1})})};if("__pushJoinTo__"===l)return(e,t)=>{f.push({to:e,mapping:t})};let y;const g=Object(u.e)(s,l);y=g&&g.get?g.get.call(p):s[l];const m=s[W.e];if(m&&m[l])return y;const b=a+(l.match(/^\d+$/)?`[${l}]`:"."+l);if(void 0!==y||!o||""!==a){if("function"==typeof y){let e;return e=Array.isArray(s)?/^(splice)$/gi.test(l)?d.get(l,y,()=>(...e)=>{var t;if(Z){const n=null===(t=a.match(/\.([^\.]+)$/))||void 0===t?void 0:t[1];let r=c.source[W.c];if(!(r&&r[n])){let t;return Z.setUndo(p,"before@splice",s),Z.sleep(()=>{t=y.call(p,...e)}),t}return y.call(p,...e)}return y.call(p,...e)}):/^(indexOf)$/gi.test(l)?(...e)=>{const t=e.map(e=>se(e)),n=s.map(e=>se(e));return y.call(n,...t)}:y:d.get(l,y,()=>(...e)=>{try{if(s instanceof Date||s instanceof Set||s instanceof Map)return s[l].call(s,...e);try{return s[l].call(p,...e)}catch(t){if(t instanceof TypeError)return s[l](...e);throw t}}catch(e){throw e}}),e}return h.push(b,l),i&&-1!==i.indexOf(l)?y:"object"==typeof y&&y&&!(Object(u.g)(y)||y instanceof RegExp||y.$$typeof||y.nodeType&&y._id)?d.get(l,y,()=>{let t;return ue(s)&&!Object(u.f)(s,l)&&(t=l),e(y,_,b,t)}):y}if(h.push(b,l),r){const e=function(e,t,n){if("parents"===n.direction){let r,o=n.node.parent;for(;o&&(!o.implementAry||!o.implementAry.find(n=>{if(n.type===e&&"children"===n.direction){try{r=n.proxy[t]}catch(e){if(!(e instanceof ne))throw e}if(void 0!==r)return!0}}));)o=o.parent;if("function"==typeof r)return r}else if("children"===n.direction){const r=[],o=n=>{n&&n.length>0&&n.forEach(n=>{n.implementAry&&n.implementAry.find(n=>{if(n.type===e){let e;try{e=n.proxy[t]}catch(e){if(!(e instanceof ne))throw e}if(void 0!==e)return r.push(e),!0}})||o(n.children)})},i=n.node.children;if(o(i),r.length>0)return r}}(t,l,r());return Array.isArray(e)?(...t)=>{let n=[];return e.forEach(e=>{n.push(e(...t))}),1==n.length?n[0]:n}:e}},set(e,t,n,r){var o;if("__proto__"===t)return e[t]=n,!0;const i=e[t];if(i!==n||Array.isArray(e)&&t&&"length"===t){const c=a+"."+t;if(Z&&ue(e)&&!Object(u.g)(i)){const n=e[W.c];!(n&&n[t])&&Z.setUndo(r,t,i)}const l=Object(u.e)(e,t);if(l&&l.set?l.set.call(r,n):e[t]=n,s(_,c,t,n,i),h.update(c,t,n),f.length>0&&f.find(({to:e,mapping:t})=>{if(!t.find(([t,r])=>{if("."+t===c){const t=r.split(".");let o=e;return t.forEach((e,r)=>{const i=t[r];r===t.length-1?o[i]=n:o=o[i]}),!0}})){const t=c.replace(/^\./,"").split(".");let r=e;t.forEach((e,o)=>{if("object"!=typeof r||!r)return!1;{const e=t[o];o===t.length-1?r[e]=n:r=r[e]}})}}),Array.isArray(e)&&t.match(/^(\d+)|length$/)){const t=null===(o=a.match(/\.([^\.]+)$/))||void 0===o?void 0:o[1];s(_,a,t,e,e)}}return!0}});return _.proxy=y,y}(e,void 0,void 0,!1)}function ue(e){return W.a in e||ce.has(e)}function se(e){return"object"==typeof e&&e&&e.__original__||e}function ae(e){return"object"==typeof e&&e&&["__observable__"]in e}function le(e){ae(e.target)&&e.target.__pushWatch__(e)}function pe(e,t,n,o,i){const c=[...arguments];n=c.find(e=>"object"==typeof e?e:void 0);const f=Object(r.useRef)(null);let u=!f.current;if(u){if(arguments.length<1)throw new Error("invalid arguments,expect <T>(class:new ()=>T|T).");if("object"!=typeof e&&"function"!=typeof e||!e)throw new Error("invalid arguments,expect <T>(class:new ()=>T|T).");let r;r="function"==typeof e?new e:e;let o=null;const i=fe(r,e,n,()=>o);if("function"==typeof t&&D.stopWatch(e=>{t(t=>{if(e(),t&&"object"==typeof t)return de(t,i),!0})}),"object"==typeof n){if(n.to){const t=_e(e,i,n.to);t&&(o=t)}else if(n.expectTo){const t=_e(e,i,n.expectTo);t&&(o=t)}"function"==typeof n.init&&n.init(se(i))}_e(e,i,"self");const u=c.find(e=>"string"==typeof e?e:void 0);u&&Y(u,i,e),f.current=i}i=c.find(e=>Array.isArray(e))||[];const s=[...i],a=Object(r.useCallback)(()=>{if(i&&!u){const r=f.current;if("function"!=typeof e)for(let t in e){const n=e[t];r[t]=n}else"function"==typeof t&&D.stopWatch(e=>{t(t=>{if(e(),t&&"object"==typeof t){for(let e in t)r[e]=t[e];return!0}})});"function"==typeof(null==n?void 0:n.init)&&n.init(se(r))}},s);return Object(r.useMemo)(a,s),f.current}function de(e,t){const n=Object.getOwnPropertyNames(e);n&&n.forEach(n=>{const r=e[n];"function"==typeof r?"constructor"!==n&&(t[n]=r):t[n]=r});const r=Object.getPrototypeOf(e);r&&r!==Object.prototype&&de(r,t)}function _e(e,t,n){if("string"!=typeof n||!/^(children|parents|self)$/gi.test(n))throw new Error("direction = 'children'|'parents' expect.");const r=new Proxy({},{has:(e,t)=>"__observable_proxy__"===t||t in e,get:(e,n)=>t[n],set:(e,n,r)=>(t[n]=r,!0)}),o=D.regListener("subject",{type:e,direction:n,proxy:r});if(o&&"self"!==n)return{direction:n,node:o}}function he(e){const[,t]=Object(r.useState)(),n=D.getCurUpdater(),o=Object(r.useMemo)(()=>({c:0,fn:e,updater:{_from_:"useComputed",hoc:e,nodeInfo:l.current,update:function(){t(o.c++)},_curSnap:void 0,getSnap(){if(!this._curSnap){const e=this;this._curSnap={version:e.nodeInfo.version,_snap_:!0,_from_:e._from_,hoc:e.hoc,nodeInfo:e.nodeInfo,update:e.update,getSnap:()=>e._curSnap}}return this._curSnap},updateSnap(){this._curSnap}}}),[]),i=Object(r.useMemo)(()=>{const t=o.updater;let r;D.setCurUpdater(t),t.updateSnap();try{r=D.keepWatch(e)}catch(e){if(!t.nodeInfo||!t.nodeInfo.props)throw e;!function e(t,n,r){if(ye.has(r))return console.error(r),void setTimeout(e=>ye.delete(r));ye.set(r,!0);if(!n||"function"!=typeof n._onError_&&"function"!=typeof n._onerror_){const o=n._parent_info_;if(o){const n=D.searchNode(o);if(null==n?void 0:n.props)return e(t,n.props,r)}throw r}return(n._onError_||n._onerror_)(r,t)}("render",t.nodeInfo.props,e)}finally{D.setCurUpdater(n)}return r},[o.c]);return Object(r.useEffect)(()=>()=>{D.cleanUpdater(o.updater)},[]),i}const ye=new WeakMap;function ge(e,t,n){Object(r.useMemo)(()=>{const r="useWatcher(target:Observable,on:string,callback:(prop: string, value: any, preValue?: any) => void).";if(!ae(e))return;if("string"!=typeof t)throw new Error(r);if("function"!=typeof n)throw new Error(r);const o=D.regListener("observer");le({target:e,on:t,exe:n,node:o})},[])}function me(e,t){const n=Object(r.useRef)();return Object(r.useMemo)(()=>(n.current||(n.current=e()),n.current),t)}function be(e,t,n,o){const i=[...arguments];let c;if(n=i.find(e=>"object"==typeof e),o=i.find(e=>Array.isArray(e)),n&&n.from)c=Object(r.useRef)();else if(c={},o)throw new Error("Updater can not be used here.");let f=!c.current;if(void 0===c||!c.current){if(arguments.length<0)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");if("function"!=typeof e||!e)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");const r={watcherPushed:{}};let o;if("function"==typeof t){const e=t(e=>{if(e&&"object"==typeof e)return r.implVal=e,!0});"object"==typeof e&&(r.implVal=e)}const i=new Proxy({},{has(e,t){return this.get(e,t)},get(t,i){if("toString"===i||"valueOf"===i||"$$typeof"===i||"constructor"===i||i===Symbol.toPrimitive||i===Symbol.toStringTag||i===Symbol.iterator)return t[i];if(r.implVal){let e=r.implVal[i];if(void 0!==e)return e}if(null==n?void 0:n.from){const t=ve("subject",e,null==n?void 0:n.from,o,i);let c;if(!r.watcherPushed[i]&&ae(t)&&"object"==typeof n.watch&&(c=n.watch)){r.watcherPushed[i]=!0;const e=new RegExp(`^${i}.(.+)$`);c.on.match(e)&&le({target:t,on:c.on.replace(e,"$1"),exe:c.exe,node:o})}return t}{const t=D.curRT.getNode();if(t&&t.subjectAry){let n;return t.subjectAry.find(t=>{if("self"===t.direction&&t.type===e)return n=t.proxy[i],!0}),n}}},set(t,r,i){let c=o,f=null==n?void 0:n.from;return f||(f="self",c=D.curRT.getNode()),c&&Ee("subject",e,f,c,r,i),!0}});n&&n.from&&(o=D.regListener("observer",{type:e,direction:n.from,proxy:i}),D.regListener("subject",{type:e,direction:"self",proxy:i})),r.proxy=i,c.current=r}if(o){const e=[...o],n=Object(r.useCallback)(()=>{if(o&&!f){const e=c.current.implVal;"function"==typeof t&&t(t=>{if(t&&"object"==typeof t){for(let n in t)e[n]=t[n];return!0}})}},e);Object(r.useEffect)(n,e)}return c.current.proxy}function ve(e,t,n,r,o){if(e+="Ary","parents"===n){let i,c=r.parent;for(;c&&(!c[e]||!c[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t)return i=e.proxy,!0}));)c=c.parent;if(void 0!==i)return i[o]}else if("children"===n){const i=[],c=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t){let t;try{t=e.proxy[o]}catch(e){if(!(e instanceof ne))throw e}if(void 0!==t)return i.push(t),!0}})||c(r.children)})},f=r.children;if(c(f),i.length>0)return i;throw new Error(`No implements found for(${o})`)}}function Ee(e,t,n,r,o,i){if(e+="Ary","parents"===n){let n=r.parent;for(;n&&(!n[e]||!n[e].find(e=>{if(e.type===t)return e.proxy[o]=i}));)n=n.parent}else if("children"===n){const n=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.type===t)return e.proxy[o]=i,!0})||n(r.children)})},c=r.children;n(c)}else"self"===n&&r.subjectAry&&r.subjectAry.find(e=>{if("self"===e.direction&&e.type===t)return e.proxy[o]=i,!0})}function je(e,t,n,o){const i=[...arguments];if(!(n=i.find(e=>"object"==typeof e))||"object"!=typeof n||!n.from)throw new Error("invalid argument config,expect pipe(typeClass, impl, config: {from:'parents'|'children'}).");let c;o=i.find(e=>Array.isArray(e)),c=n&&(n.from||(null==n?void 0:n.expectTo))?Object(r.useRef)():{};let f=!c.current;if(void 0===c||!c.current){if(arguments.length<0)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");if("function"!=typeof e||!e)throw new Error("invalid arguments,expect <T>(class:new ()=>T).");const r={watcherPushed:{}};let o;if("function"==typeof t){const e=t(e=>{if(e&&"object"==typeof e)return r.implVal=e,!0});"object"==typeof e&&(r.implVal=e)}function u(t,r){let i;try{i=Oe("implement",e,n.expectTo,o,t)}catch(e){i=[]}if(!Array.isArray(i)){if("function"!=typeof i)throw new Error("ExpectTo's value must be a Function type.");i=[i]}return r&&i.push(r),i.length>0?(...e)=>{let t=[];return i.forEach(n=>{t.push(n(...e))}),1==t.length?t[0]:t}:()=>{}}const i=new Proxy({},{get(e,t){if("toString"===t||"valueOf"===t||"$$typeof"===t||"constructor"===t||t===Symbol.toPrimitive||t===Symbol.toStringTag||t===Symbol.iterator)return e[t];if(r.implVal){let e=r.implVal[t];if(void 0!==e){if(null==n?void 0:n.expectTo){if("function"!=typeof e)throw new Error("ExpectTo's value must be a Function type.");return u(t,e)}return e}}return(null==n?void 0:n.expectTo)?u(t):void 0},set:(t,r,i)=>(we("subject",e,n.from,o,r,i),!0)});o=D.regListener("implement",{type:e,direction:n.from,proxy:i}),r.proxy=i,c.current=r}if(o){const e=[...o],n=Object(r.useCallback)(()=>{if(o&&!f){const e=c.current.implVal;"function"==typeof t&&t(t=>{if(t&&"object"==typeof t){for(let n in t)e[n]=t[n];return!0}})}},e);Object(r.useEffect)(n,e)}return c.current.proxy}function Oe(e,t,n,r,o){if(e+="Ary","parents"===n){let i,c=r.parent;for(;c&&(!c[e]||!c[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t)return i=e.proxy,!0}));)c=c.parent;if(void 0!==i)return i[o]}else if("children"===n){const i=[],c=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.direction!==n&&"self"!==e.direction&&e.type===t){let t;try{t=e.proxy[o]}catch(e){if(!(e instanceof ne))throw e}if(void 0!==t)return i.push(t),!0}})||c(r.children)})},f=r.children;if(c(f),i.length>0)return i;throw new Error(`No implements found for(${o})`)}}function we(e,t,n,r,o,i){if(e+="Ary","parents"===n){let n=r.parent;for(;n&&(!n[e]||!n[e].find(e=>{if(e.type===t)return e.proxy[o]=i}));)n=n.parent}else if("children"===n){const n=r=>{r&&r.length>0&&r.forEach(r=>{r[e]&&r[e].find(e=>{if(e.type===t)return e.proxy[o]=i,!0})||n(r.children)})},c=r.children;n(c)}else"self"===n&&r.subjectAry&&r.subjectAry.find(e=>{if("self"===e.direction&&e.type===t)return e.proxy[o]=i,!0})}function xe(e,t){if(!ae(e))throw new Error("The join to object must be an observable object.");if(ae(n=e)&&n.__isExpectTo__)throw new Error("The observable object has expectTo,join is not allowed.");var n;return{joinTo(n,r){if("object"==typeof n){if(!ae(n))throw new Error("The join from object must be an observable object.");if((null==t?void 0:t.length)!==(null==r?void 0:r.length))throw new Error("The mapping props(in from and to) must be a same length.");let o=[];if((null==t?void 0:t.length)>0)null==t||t.forEach((e,t)=>{o.push([e,r[t]])});else{Object(u.c)(e).forEach(e=>{o.push([e,e])})}!function(e,t,n){e.__pushJoinTo__(t,n)}(e,n,o),function(e,t,n){e.__pushJoinFrom__(t,n)}(n,e,o)}}}}function Te(e){if(!ae(e))throw new Error("The join to object must be an observable object.");const t=fe({});return new Proxy(t,{has:(n,r)=>r in t||r in e,get(n,r,o){const i=t[r];return r in t?i:e[r]},set:(e,n,r,o)=>(t[n]=r,!0),ownKeys:t=>Reflect.ownKeys(e),getOwnPropertyDescriptor:(t,n)=>Reflect.getOwnPropertyDescriptor(e,n)})}function Pe(e,t){let n=Object.getOwnPropertyDescriptor(e,W.e);if(n)n.value[t]=!0;else{let n,r=Object.getPrototypeOf(e);for(;r&&r!==Object.prototype&&(n=Object.getOwnPropertyDescriptor(r,W.e),!n);)r=Object.getPrototypeOf(r);const o=Object.assign({},n&&n.value);Object.defineProperty(e,W.e,{value:o,writable:!0}),o[t]=!0}}let Ae;const Ie={push(e){De.push(e),this.handler.size+=1},handler:fe({name:"Undo",size:(De=[{}]).length,exe(){if(De.length<=1)return;const e=De.pop();e.undo(),Ie.handler.size-=1,Se.push(e)}})};var De;const Se=(e=>({push(t){e.push(t),this.handler.size+=1},handler:fe({name:"Redo",size:e.length,exe(){if(e.length<=1)return;const t=e.pop();t.redo(),Se.handler.size-=1,Ie.push(t)}})}))([{}]),Me=Ie.handler,Re=Se.handler;let Ce;function We(e){setTimeout(e=>{if(Ce){const e=Ce.until-((new Date).getTime()-Ce.from);e<=0?(Ie.push(Ce.dump),Ce=void 0):We(e)}},e)}function Ue(e,t){if(Ce)if(Ae!==e)Ie.push(Ce.dump),Ce=void 0,Ae=void 0;else{if(!(Ce.until>0&&(new Date).getTime()-Ce.from>Ce.until))return{on(e){},wait(){},commit(e){if(Ce.until<0)e&&e.wait?(Ce.from=(new Date).getTime(),We(Ce.until)):(Ie.push(Ce.dump),Ce=void 0);else{let t=Ce.until-((new Date).getTime()-Ce.from);if(t<=0)return Ie.push(Ce.dump),void(Ce=void 0);e&&e.wait&&(Ce.from=(new Date).getTime(),t=Ce.until),We(t)}},cancel(){Ae=void 0,n.undo()}};Ie.push(Ce.dump),Ce=void 0}Ae=e;let n=function(e){return Z=new ee(e),Z}(t);return{on(e){},wait(){if(!Ce){const e=n.dump();Ce={from:(new Date).getTime(),until:-1,dump:e}}},commit(e){const t=n.dump();e&&e.wait?Ce={from:(new Date).getTime(),until:e.wait,dump:t}:(Ae=void 0,Ie.push(t))},cancel(){Ae=void 0,n.undo()}}}const ke=function(e,t,n){return e.evt instanceof MouseEvent?Ne(...arguments):Le(...arguments)};function Le(e,t,n){const r=(null==n?void 0:n.document)||document,o=e.currentTarget,i=o.offsetWidth,c=o.offsetHeight,f=3==arguments.length&&n&&n.relDom,u=(3==arguments.length&&n&&n.zoom,$e(o,f)),s=f?$e(f):{x:0,y:0},a=document.body.scrollTop||document.documentElement.scrollTop,l=document.body.scrollLeft||document.documentElement.scrollLeft;let p,d,_,h,y,g=e.pageX-u.x,m=e.pageY-u.y;if(!t)return u;{D.curRT.setInfoIdForDelay();const e=e=>{const n=e.pageX-g,r=e.pageY-m,f=n-p,b=r-d;p=e.pageX-g,d=e.pageY-m,_=e.pageX-s.x-l,h=e.pageY-s.y-a,"finish"===y?t({po:{x:p,y:d},epo:{ex:_,ey:h},dpo:{dx:0,dy:0},adpo:{adx:n,ady:r},targetStyle:{x:u.x,y:u.y,w:i,h:c}},y,o):0==f&&0==b||(y=y?"moving":"start",t({po:{x:p,y:d},epo:{ex:_,ey:h},dpo:{dx:f,dy:b},adpo:{adx:n,ady:r},targetStyle:{x:u.x,y:u.y,w:i,h:c}},y,o))};let n=!1;r.onmousemove=t=>{n||(n=!0,ke.event=t);try{e(t)}catch(e){console.error(e)}},r.onmouseup=t=>{setTimeout(()=>ke.event=void 0);try{const n=D.applyBatch();y&&(y="finish",e(t)),n.commit()}catch(e){throw e}finally{r.onmousemove=null,r.onmouseup=null,D.curRT.clearDelay()}}}}function Ne(e,t,n){const r=e.currentTarget,o=r.getStage(),i=Fe(r),c=document.body.scrollTop||document.documentElement.scrollTop,f=document.body.scrollLeft||document.documentElement.scrollLeft,u={x:i.x,y:i.y,w:r.width(),h:r.height()};let s,a,l,p,d,_=(e=e.evt).pageX-u.x,h=e.pageY-u.y,y=0,g=0;if(!t)return u;{D.curRT.setInfoIdForDelay();const e=(e,n)=>{const o=e.pageX-_-s||0,i=e.pageY-h-a||0;s=e.pageX-_,a=e.pageY-h,l=e.pageX-y-f,p=e.pageY-g-c,(n||0!=o||0!=i)&&(d=n?"finish":d?"moving":"start",t({po:{x:s,y:a},epo:{ex:l,ey:p},dpo:{dx:o,dy:i},targetStyle:u},d,r))};let n=!1;o.on("mousemove",t=>{n||(n=!0,ke.event=t);try{e(t.evt)}catch(e){console.error(e)}});const i=t=>{setTimeout(()=>ke.event=void 0);try{const n=D.applyBatch();d&&e(t.evt||t,"finish"),n.commit()}catch(e){throw e}finally{o.off("mousemove"),o.off("mouseup"),D.curRT.clearDelay()}};o.on("mouseup",i)}}function $e(e,t){const n=document.body.scrollTop||document.documentElement.scrollTop,r=document.body.scrollLeft||document.documentElement.scrollLeft;if(t){const o=e.getBoundingClientRect(),i=t.getBoundingClientRect();return{x:o.left-i.left+r,y:o.top-i.top+n,w:e.offsetWidth,h:e.offsetHeight}}{const t=e.getBoundingClientRect();return{x:t.left+r,y:t.top+n,w:e.offsetWidth,h:e.offsetHeight}}}function Fe(e,t){if(t){const n=e.getAbsolutePosition(),r=t.getAbsolutePosition();return{x:n.x-r.x,y:n.y-r.y,w:e.width(),h:e.height()}}{const t=e.getAbsolutePosition(),n=e.getStage();if(n&&n.content instanceof W.g){const r=n.content.getBoundingClientRect();return{x:t.x+r.left,y:t.y+r.top,w:e.width(),h:e.height()}}}}function Be(e){function t(t){e&&e(t)}return t.stop=function(e){var n;"function"==typeof e.stopPropagation?e.stopPropagation():"function"==typeof(null===(n=e.evt)||void 0===n?void 0:n.stopPropagation)&&(e.evt.stopPropagation(),e.cancelBubble=!0),t(e)},t.prevent=function(e){var n;"function"==typeof e.preventDefault?e.preventDefault():"function"==typeof(null===(n=e.evt)||void 0===n?void 0:n.preventDefault)&&e.evt.preventDefault(),t(e)},t.stop.prevent=function(e){var n;"function"==typeof e.preventDefault?e.preventDefault():"function"==typeof(null===(n=e.evt)||void 0===n?void 0:n.preventDefault)&&e.evt.preventDefault(),t.stop(e)},t}const Ke=D.stopWatch,ze=D.keepWatch,Ve=D.stopUpdate}])}));